<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="format-detection" content="telephone=no">
    <link rel='stylesheet' href='/stylesheets/style.css'>
    <script>
      window.onload = ()=>{
        window.setInterval(()=>{
          console.log("interval");
            if(parseInt(document.getElementById("stamina").textContent) < 600)
              document.getElementById("stamina").textContent = parseInt(document.getElementById("stamina").textContent) + 1;        
        },1000);

        console.log(document.getElementById("stamina"));
      }
    </script>
  </head>
  <body >
    <div class="wrapper">
     <% const formatter = new Intl.NumberFormat('ja-JP') %>
    <h1><%= subTitle %></h1>    
    現在のチャンピオン:<%= champion.name %>さん
    HP: <%= formatter.format(champion.currentHP) %>/<%=formatter.format(champion.maxHP) %>
    <% let homepage = '<a href="'+ champion.homePageURL+'">' + champion.homePageName + '</a>'%>
    おすすめのHP: <%- homepage %>
    <div class="instant-status">
    <h3><%= user.name %>さんのステータス:</h3>
    <ul>  
      <li>HP:<%=user.currentHP %>/<%=user.maxHP %></li>
      <li>レベル: <%=user.level %></li>
      <li>経験値: <%= user.exp %>/<%= user.level*300 %></li>
      <li>所持金: <%= formatter.format(user.money)  %>C/<%= formatter.format(configuration.maxMoney) %>C</li>
      <li>スタイル: <%= job.name %></li>
      <li>スタイルレベル: <%= user.jobLevel %> </li>
      <li>スタミナ: <x id="stamina"><%= stamina %></x></li>
      <li>武器 <%=weapon.name %> 威力: <%= weapon.attack %></li>
      <li>防具 <%=armor.name %> 防御力: <%= armor.defence %></li>
      <li>装飾品 <%=accessory.name %></li>
    </ul>
    <a href="/changeArts" class="btn-square">戦術を変更する</a>
    <% if(champion.userId !== user.userId){ %>
    <form action="/vsChampion" method="post">
      <button type="submit" class="btn-square">チャンピオンに挑む</button>
    </form>
    <% }else{ %>
      ※あなたがチャンピオンなので挑めません
    <% } %>
    <form action="" method="post">
      <button type="submit" class="btn-square">※準備中</button>
    </form>
    </div>
    <div>
      <a href="/inn" class="btn-square">HPを回復する(有料)</a>
      <a href="/equipmentStorage" class="btn-square">装備品倉庫へ</a>
      <a href="/bank" class="btn-square">銀行へ</a>
    
      <a href="/itemShop" class="btn-square">道具屋</a>
      <a href="/weaponShop" class="btn-square">武器屋</a>
      <a href="/armorShop" class="btn-square">防具屋へ</a>
      <a href="/accessoryShop" class="btn-square">装飾品屋へ</a>
      <a href="/changeJob" class="btn-square">転職の祠へ</a>
      <a href="/status" class="btn-square">画面更新</a>
      <a href="/changeStatus" class="btn-square">ステータス変更画面へ</a>
    </div>
    <div>
      その辺を探索
      <form action="/vsMonster" method="post">
        <select name="difficulty">
          <option value="0">そのへんの森(弱い敵が出現)</option>
          <option value="1">沖合(それなりの敵が出現)</option>
          <option value="2">樹海(割と強い敵が出現)</option>
          <option value="3">魔境(とても強い敵が出現)</option>
        </select>
        <button type="submit" class="btn-square">挑む</button>
      </form>
    </div>
    <%if(configuration.isGuerrillaAppeared(user)){ %>
    <div>
      突然の出現
      <form action="/vsGuerrilla" method="post">
        <button type="submit" class="btn-square">幻影の塔に行く！</button>
      </form>
    </div>
    <%}%>

    <div>
      勝ち抜きボスバトル
      <form action="/legendPlace" method="post">
        <select name="difficulty">
          <% for(let i = 0;i <= user.degree && i < configuration.legendPlaceName.length;++i){ %>
            <%let output = '<option value="'+i+'">'+configuration.legendPlaceName[i]+"</option>" %>
            <%- output %>
          <%}%>
        </select>
        <button type="submit" class="btn-square">挑む</button>
      </form>
    </div>
    <div>
      ポータル
      <form action="" method="post">
        <button type="submit" class="btn-square">修練場へ挑む</button>
      </form>
    </div>
    </div>
  </body>
</html>
